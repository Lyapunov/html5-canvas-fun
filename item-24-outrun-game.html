<!DOCTYPE HTML>
<html>
   <head>
      <style>
         body {
            margin : 0px;
            padding: 0px;
         }
      </style>
   </head>
   <body>
   	<canvas id="canvas" width="500" height="500"></canvas>

      <script>
         var mainItem     = document.getElementById('canvas');
         var context      = mainItem.getContext('2d');
         var screenWidth  = mainItem.width  = window.innerWidth  - 20;
         var screenHeight = mainItem.height = window.innerHeight - 20;
         var ANIMATION;  // ??

         var eyedist = 2.5;
         var roadWidth = 2000;
         var segmentLength = 800;
         var numberOfQuads = 200;
         var pos = 0;
         var camHeight = 1500;

var carVertices = [
   [-0.970807, 0.399997, 1.02869],
   [-0.970807, 0.143497, 1.28519],
   [-0.970807, 0.399997, 1.54169],
   [-0.970807, 0.656497, 1.28519],
   [-0.714307, 0.349956, 1.03362],
   [-0.714307, 0.148425, 1.33523],
   [-0.714307, 0.450037, 1.53676],
   [-0.714307, 0.651568, 1.23515],
   [-0.970807, 0.399997, -1.53131],
   [-0.970807, 0.143497, -1.27481],
   [-0.970807, 0.399997, -1.01831],
   [-0.970807, 0.656497, -1.27481],
   [-0.714307, 0.349956, -1.52638],
   [-0.714307, 0.148425, -1.22477],
   [-0.714307, 0.450037, -1.02324],
   [-0.714307, 0.651568, -1.32485],
   [0.729193, 0.399997, -1.53131],
   [0.729193, 0.143497, -1.27481],
   [0.729193, 0.399997, -1.01831],
   [0.729193, 0.656497, -1.27481],
   [0.985693, 0.349956, -1.52638],
   [0.985693, 0.148425, -1.22477],
   [0.985693, 0.450037, -1.02324],
   [0.985693, 0.651568, -1.32485],
   [0.729193, 0.399997, 1.02869],
   [0.729193, 0.143497, 1.28519],
   [0.729193, 0.399997, 1.54169],
   [0.729193, 0.656497, 1.28519],
   [0.985693, 0.349956, 1.03362],
   [0.985693, 0.148425, 1.33523],
   [0.985693, 0.450037, 1.53676],
   [0.985693, 0.651568, 1.23515],
   [-0.967557, 0.299997, 2.12519],
   [-0.992557, 0.924997, 2.02519],
   [-0.967557, 0.299997, -2.17481],
   [-0.992557, 0.974997, -2.11153],
   [0.982443, 0.299997, 2.12519],
   [1.00744, 0.924997, 2.02519],
   [0.982443, 0.299997, -2.17481],
   [1.00744, 0.974997, -2.11153],
   [-0.961307, 0.999997, 0.787692],
   [-0.961307, 0.999997, -1.53731],
   [0.976193, 0.999997, -1.53731],
   [0.976193, 0.999997, 0.787692],
   [-0.670682, 1.5, 0.188942],
   [-0.670682, 1.5, -1.18856],
   [0.685568, 1.5, -1.18856],
   [0.685568, 1.5, 0.188942],
   [0.007443, 1.065, -2.12481],
   [0.007443, 0.299997, -2.17481],
   [0.007443, 0.999997, 2.14019],
   [0.007443, 0.299997, 2.22519],
   [0.007443, 1.065, -1.63731],
   [0.007443, 1.065, 0.837692],
   [0.007443, 1.565, -1.28856],
   [0.007443, 1.565, 0.238942],
   [0.977347, 0.949997, 2.07519],
   [-0.962295, 0.949997, 2.07519],
   [-0.960193, 0.999997, -2.12481],
   [0.975877, 0.999997, -2.12481],
   [-0.992557, 0.974997, -0.374808],
   [-0.967557, 0.299997, -0.374808],
   [1.00744, 0.974997, -0.374808],
   [0.982443, 0.299997, -0.374808],
   [0.007443, 0.299997, -0.374808],
   [-0.961307, 0.999997, -0.374808],
   [0.976193, 0.999997, -0.374808],
   [-0.670682, 1.525, -0.499808],
   [0.685568, 1.525, -0.499808],
   [0.007443, 1.59, -0.499808],
   [0.491818, 1.05, -1.61231],
   [0.346506, 1.55, -1.26356],
   [0.492395, 0.999997, 2.12519],
   [0.491818, 1.05, 0.837692],
   [0.346506, 1.55, 0.238942],
   [0.49166, 1.05, -2.12481],
   [0.346506, 1.575, -0.499808],
   [-0.476932, 1.05, 0.837692],
   [-0.476375, 1.05, -2.12481],
   [-0.331619, 1.55, 0.238942],
   [-0.476932, 1.05, -1.61231],
   [-0.331619, 1.55, -1.26356],
   [-0.477426, 0.999997, 2.12519],
   [-0.331619, 1.575, -0.499808],
   [1.00744, 0.662497, -2.17481],
   [1.00744, 0.662497, 2.12519],
   [1.00744, 0.662497, -0.374808],
   [-0.992557, 0.662497, 2.12519],
   [-0.992557, 0.662497, -2.17481],
   [-0.992557, 0.662497, -0.374808],
   [0.007443, 0.662497, -2.17481],
   [0.007443, 0.662494, 2.24019],
   [0.494943, 0.299997, 2.22519],
   [0.884943, 0.299997, -2.17481],
   [0.494943, 0.299997, -0.374808],
   [0.907443, 0.662497, -2.17481],
   [0.507443, 0.662495, 2.22519],
   [-0.870057, 0.299997, -2.17481],
   [-0.480057, 0.299997, 2.22519],
   [-0.480057, 0.299997, -0.374808],
   [-0.892557, 0.662497, -2.17481],
   [-0.492557, 0.662495, 2.22519],
   [0.907476, 0.646872, 2.26019],
   [0.907476, 0.365622, 2.26019],
   [0.45746, 0.365622, 2.36019],
   [-0.442573, 0.365622, 2.36019],
   [0.007443, 0.365622, 2.37519],
   [-0.89259, 0.365622, 2.26019],
   [-0.89259, 0.646872, 2.26019],
   [0.007443, 0.646869, 2.37519],
   [0.45746, 0.64687, 2.36019],
   [-0.442573, 0.64687, 2.36019],
   [-0.992557, 0.610414, -2.17481],
   [-0.992557, 0.45208, -2.17481],
   [1.00744, 0.610414, -2.17481],
   [1.00744, 0.45208, -2.17481],
   [1.00744, 0.610414, 2.12519],
   [1.00744, 0.40208, 2.12519],
   [0.007443, 0.630622, -2.27481],
   [0.007443, 0.356765, -2.27481],
   [1.00744, 0.610414, -0.374808],
   [1.00744, 0.45208, -0.374808],
   [-0.992557, 0.610414, -0.374808],
   [-0.992557, 0.45208, -0.374808],
   [-0.992557, 0.40208, 2.12519],
   [-0.992557, 0.610414, 2.12519],
   [0.952443, 0.630622, -2.27481],
   [0.952443, 0.356765, -2.27481],
   [-0.937557, 0.630622, -2.27481],
   [-0.937557, 0.356765, -2.27481],
   [0.907476, 0.599997, 2.27519],
   [0.907476, 0.412497, 2.27519],
   [-0.89259, 0.412497, 2.27519],
   [-0.89259, 0.599997, 2.27519],
   [0.007443, 0.412495, 2.39019],
   [0.007443, 0.599993, 2.39019],
   [0.45746, 0.599995, 2.37519],
   [0.45746, 0.412496, 2.37519],
   [-0.442573, 0.599995, 2.37519],
   [-0.442573, 0.412496, 2.37519],
   [-0.515493, 0.931701, 2.10282],
   [-0.927631, 0.924201, 2.06032],
   [0.942668, 0.924201, 2.06032],
   [0.53046, 0.931701, 2.10282],
   [-0.528354, 0.679825, 2.18782],
   [-0.953354, 0.679826, 2.10282],
   [0.968251, 0.679826, 2.10282],
   [0.543251, 0.679825, 2.18782],
   [-0.452713, 1.0615, 0.822723],
   [-0.912869, 1.014, 0.772723],
   [-0.314666, 1.5365, 0.253911],
   [-0.636775, 1.489, 0.203911],
   [0.927756, 1.014, 0.772723],
   [0.651662, 1.489, 0.203911],
   [0.4676, 1.0615, 0.822723],
   [0.007443, 1.0765, 0.822723],
   [0.329553, 1.5365, 0.253911],
   [0.007443, 1.5515, 0.253911],
   [-0.992557, 0.974997, -0.374808],
   [-0.946775, 1.02562, 0.711473],
   [-0.685213, 1.47562, 0.172598],
   [-0.946775, 1.02562, -0.334777],
   [-0.685213, 1.49812, -0.447277],
   [-0.946775, 1.02562, -0.427339],
   [-0.946775, 1.02562, -1.47359],
   [-0.685213, 1.49812, -0.539839],
   [-0.685213, 1.47562, -1.15971],
   [-0.946775, 1.02562, -0.427339],
   [-0.946775, 1.02562, -1.47359],
   [-0.685213, 1.49812, -0.539839],
   [-0.685213, 1.47562, -1.15971],
   [-0.945468, 1.02793, -0.432067],
   [-0.945468, 1.02793, -1.46785],
   [-0.686521, 1.4957, -0.543442],
   [-0.686521, 1.47343, -1.15712],
   [-0.945468, 1.02793, 0.704613],
   [-0.686521, 1.47343, 0.171127],
   [-0.945468, 1.02793, -0.331174],
   [-0.686521, 1.4957, -0.442549],
   [0.961662, 1.02562, -0.334777],
   [0.961662, 1.02562, 0.711473],
   [0.7001, 1.49812, -0.447277],
   [0.7001, 1.47562, 0.172598],
   [0.7001, 1.47562, -1.15971],
   [0.961662, 1.02562, -1.47359],
   [0.961662, 1.02562, -0.427339],
   [0.7001, 1.49812, -0.539839],
   [0.704644, 1.468, -1.15069],
   [0.957117, 1.03364, -1.45366],
   [0.957117, 1.03364, -0.443769],
   [0.704644, 1.48972, -0.552359],
   [0.957117, 1.03364, -0.322257],
   [0.957117, 1.03364, 0.687636],
   [0.704644, 1.48972, -0.430848],
   [0.704644, 1.468, 0.167487],
   [-0.967557, 0.299997, 1.69707],
   [1.00744, 0.937497, 1.42519],
   [0.007443, 0.299997, 1.57519],
   [-0.992557, 0.937497, 1.42519],
   [0.982443, 0.299997, 1.69707],
   [1.00744, 0.762497, 1.49199],
   [-0.992557, 0.762497, 1.49199],
   [0.494943, 0.299997, 1.57519],
   [-0.480057, 0.299997, 1.57519],
   [-0.992557, 0.45208, 1.69707],
   [1.00744, 0.45208, 1.69707],
   [-0.992557, 0.946872, 0.975192],
   [0.982443, 0.299997, 0.876754],
   [1.00744, 0.762497, 1.08183],
   [1.00744, 0.45208, 0.876754],
   [-0.967557, 0.299997, 0.876754],
   [1.00744, 0.946872, 0.975192],
   [0.007443, 0.299997, 0.975192],
   [-0.992557, 0.762497, 1.08183],
   [0.494943, 0.299997, 0.975192],
   [-0.480057, 0.299997, 0.975192],
   [-0.992557, 0.45208, 0.876754],
   [-0.992557, 0.974997, -1.58731],
   [0.982443, 0.299997, -1.68731],
   [-0.967557, 0.299997, -1.68731],
   [1.00744, 0.974997, -1.58731],
   [0.007443, 0.299997, -1.68731],
   [1.00744, 0.762497, -1.5245],
   [-0.992557, 0.762497, -1.5245],
   [0.787443, 0.299997, -1.68731],
   [-0.772557, 0.299997, -1.68731],
   [1.00744, 0.45208, -1.68731],
   [-0.992557, 0.45208, -1.68731],
   [-0.946775, 1.02562, -1.21203],
   [-0.685213, 1.48125, -1.00474],
   [-0.946775, 1.02562, -1.21203],
   [-0.685213, 1.48125, -1.00474],
   [-0.967557, 0.299997, -0.859183],
   [1.00744, 0.974997, -0.959183],
   [0.007443, 0.299997, -0.859183],
   [-0.992557, 0.762497, -1.022],
   [0.714318, 0.299997, -0.859183],
   [-0.699432, 0.299997, -0.859183],
   [-0.992557, 0.45208, -0.859183],
   [-0.992557, 0.974997, -0.959183],
   [0.982443, 0.299997, -0.859183],
   [1.00744, 0.762497, -1.022],
   [1.00744, 0.45208, -0.859183],
   [-0.946775, 1.02562, -1.01585],
   [-0.685213, 1.48547, -0.888519],
   [-0.946775, 1.02562, -1.01585],
   [-0.685213, 1.48547, -0.888519],
   [-0.686521, 1.48317, -0.888635],
   [0.4676, 1.06165, -1.60359],
   [0.927756, 1.01415, -1.52859],
   [0.329553, 1.53665, -1.27228],
   [0.651662, 1.48915, -1.19728],
   [-0.636775, 1.48915, -1.19728],
   [-0.912869, 1.01415, -1.52859],
   [-0.452713, 1.06165, -1.60359],
   [0.007443, 1.0759, -1.62859],
   [-0.314666, 1.53665, -1.27228],
   [0.007443, 1.5509, -1.29728],
   [0.444592, 1.07271, -1.59531],
   [0.88174, 1.02759, -1.52031],
   [0.313447, 1.52396, -1.28056],
   [0.619451, 1.47884, -1.20556],
   [-0.604564, 1.47884, -1.20556],
   [-0.866854, 1.02759, -1.52031],
   [-0.429705, 1.07271, -1.59531],
   [0.007443, 1.08625, -1.62031],
   [-0.298561, 1.52396, -1.28056],
   [0.007443, 1.5375, -1.30556],
   [0.007443, 0.999997, 2.14019],
   [0.492395, 0.999997, 2.12519],
   [-0.477426, 0.999997, 2.12519],
   [0.007443, 0.662494, 2.24019],
   [0.507443, 0.662495, 2.22519],
   [-0.492557, 0.662495, 2.22519],
   [0.007443, 0.976237, -2.12256],
   [1.05744, 0.737497, 1.49199],
   [-1.04256, 0.737497, 1.49199],
   [-1.04256, 0.42708, 1.69707],
   [1.05744, 0.42708, 1.69707],
   [1.05744, 0.737497, 1.08183],
   [1.05744, 0.42708, 0.876754],
   [-1.04256, 0.737497, 1.08183],
   [-1.04256, 0.42708, 0.876754],
   [1.05744, 0.737497, -1.5245],
   [-1.04256, 0.737497, -1.5245],
   [1.05744, 0.42708, -1.68731],
   [-1.04256, 0.42708, -1.68731],
   [-1.04256, 0.737497, -1.022],
   [-1.04256, 0.42708, -0.859183],
   [1.05744, 0.737497, -1.022],
   [1.05744, 0.42708, -0.859183],
   [-1.04256, 0.714216, 1.46123],
   [-1.04256, 0.450362, 1.63554],
   [-1.04256, 0.714216, 1.11259],
   [-1.04256, 0.450362, 0.938278],
   [1.05744, 0.714216, 1.46123],
   [1.05744, 0.450362, 1.63554],
   [1.05744, 0.714216, 1.11259],
   [1.05744, 0.450362, 0.938278],
   [1.05744, 0.72197, -1.48681],
   [1.05744, 0.442607, -1.6252],
   [1.05744, 0.72197, -1.05968],
   [1.05744, 0.442607, -0.921292],
   [-1.04256, 0.714216, -1.48681],
   [-1.04256, 0.450362, -1.6252],
   [-1.04256, 0.714216, -1.05968],
   [-1.04256, 0.450362, -0.921292],
   [-0.429705, 1.07257, 0.807503],
   [-0.866854, 1.02745, 0.760003],
   [-0.298561, 1.52382, 0.267131],
   [-0.604564, 1.4787, 0.219631],
   [0.88174, 1.02745, 0.760003],
   [0.619451, 1.4787, 0.219631],
   [0.444592, 1.07257, 0.807503],
   [0.007443, 1.08682, 0.807503],
   [0.313447, 1.52382, 0.267131],
   [0.007443, 1.53807, 0.267131],
];
var carNormals = [
   [0.0009, -0.1174, -0.9931],
   [-0.8742, 0.4855, 0.0066],
   [-0.1696, 0.8332, -0.5263],
   [0.0233, 0.581, -0.8136],
   [0.8755, 0.4831, -0.0065],
   [-0.8784, 0.1701, 0.4466],
   [-0.7707, 0.6371, 0.0129],
   [0.8609, 0.5086, 0.0069],
   [-0.8755, 0.4831, -0.0065],
   [-0.0602, 0.6503, -0.7573],
   [1, -0, 0],
   [-1, 0, 0],
   [0.4572, 0.1054, 0.8831],
   [0.8795, 0.1694, 0.4447],
   [-0.099, 0.8631, 0.4952],
   [0, 0, -1],
   [-0.7057, 0.2425, 0.6657],
   [0.0723, -0.3648, 0.9283],
   [0.099, 0.8631, 0.4952],
   [-0.0723, -0.3647, 0.9283],
   [-0.4572, 0.1057, 0.8831],
   [0.7056, 0.2423, 0.6659],
   [0.6247, 0.7809, 0],
   [0.6209, 0.7839, -0.0003],
   [0.7711, 0.6366, 0.0129],
   [-0.6225, 0.7826, -0.0002],
   [-0.8641, 0.5029, 0.0183],
   [-0.8609, 0.5086, 0.0069],
   [-0.8699, 0.4933, 0],
   [-0.8625, 0.5061, -0.0068],
   [0.8641, 0.5029, 0.0183],
   [0.8742, 0.4855, 0.0066],
   [0.8699, 0.4933, 0],
   [0.8625, 0.5061, -0.0068],
   [0.868, 0.4962, -0.018],
   [-0.868, 0.4962, -0.018],
   [0.1696, 0.8332, -0.5263],
   [-0.0233, 0.581, -0.8136],
   [0.0602, 0.6503, -0.7573],
   [-0.0009, -0.1174, -0.9931],
   [-0.0055, 0.1814, -0.9834],
   [0.0055, 0.1814, -0.9834],
   [0.2288, 0.8641, 0.4483],
   [0.3896, 0.6057, 0.6937],
   [0.5579, 0.8188, 0.1351],
   [0.0902, 0.963, 0.2539],
   [0.0969, 0.9953, 0.0005],
   [0.1863, 0.7699, -0.6103],
   [0, 0.8505, -0.526],
   [0, 1, 0.0008],
   [0, 0.926, 0.3776],
   [-0.1386, 0.8799, 0.4545],
   [-0.1213, 0.6496, 0.7505],
   [0, 0.7179, 0.6961],
   [-0.4799, 0.8342, 0.2718],
   [-0.1246, 0.6765, 0.7258],
   [0.1147, 0.9493, -0.2927],
   [0.0515, 0.6719, -0.7388],
   [0, 0.6724, -0.7401],
   [0, 0.9124, -0.4093],
   [-0.0515, 0.6719, -0.7389],
   [-0.1147, 0.9493, -0.2927],
   [-0.0902, 0.963, 0.2539],
   [-0.2288, 0.8641, 0.4483],
   [0, 0.999, 0.0443],
   [0, 0.9416, 0.3368],
   [-0.0969, 0.9953, 0.0005],
   [-0.5635, 0.8261, -0.0005],
   [0.1386, 0.8799, 0.4545],
   [0.4799, 0.8342, 0.2718],
   [0.5635, 0.8261, -0.0005],
   [0.5082, 0.8498, -0.1397],
   [0.2703, 0.6466, -0.7133],
   [0.1213, 0.6496, 0.7505],
   [-0.5576, 0.819, 0.1351],
   [-0.389, 0.6058, 0.694],
   [-0.2707, 0.6449, -0.7147],
   [-0.507, 0.8505, -0.1399],
   [0.1246, 0.6765, 0.7258],
   [0.0869, 0.8406, 0.5346],
   [0.1718, 0.3354, -0.9263],
   [0, 0.4963, -0.8681],
   [-0.0869, 0.8406, 0.5346],
   [0.0823, 0.8532, 0.515],
   [0, 0.8155, 0.5787],
   [-0.0823, 0.8532, 0.515],
   [-0.1863, 0.7699, -0.6103],
   [-0.4685, 0.7982, -0.3787],
   [0.4685, 0.7982, -0.3787],
   [0.1376, 0.3895, -0.9107],
   [-0.1718, 0.3354, -0.9263],
   [-0.1376, 0.3895, -0.9107],
   [0, 0.2847, 0.9586],
   [0.0292, 0.2846, 0.9582],
   [-0.0292, 0.2846, 0.9582],
   [0, 0, 1],
   [-0.1731, 0.8376, -0.5181],
   [0.1731, 0.8376, -0.5181],
   [0.0623, 0.6515, -0.756],
   [-0.0623, 0.6515, -0.756],
   [-0.0872, 0.7266, 0.6815],
   [0, 0.7357, 0.6773],
   [0.0806, 0.814, 0.5752],
   [0, 0.799, 0.6013],
   [0.1154, 0.8338, 0.5399],
   [-0.0806, 0.814, 0.5752],
   [-0.1154, 0.8338, 0.5399],
   [0, 0.5384, -0.8427],
   [-0.1377, 0.5108, -0.8485],
   [0.1377, 0.5108, -0.8485],
   [0.1943, 0.4245, -0.8843],
   [-0.1943, 0.4245, -0.8843],
   [-0.1561, 0.7011, 0.6958],
   [0.0872, 0.7266, 0.6815],
   [0.1561, 0.7011, 0.6958],
   [-0.8642, 0.5029, 0.0183],
   [-0.8609, 0.5087, 0.0069],
   [0.8609, 0.5087, 0.0069],
   [-0.8707, 0.4918, 0.004],
   [-0.8657, 0.5004, 0.0038],
   [-0.8647, 0.5022, 0.0105],
   [-0.8686, 0.4953, 0.0115],
   [0.8657, 0.5004, 0.0038],
   [0.8707, 0.4918, 0.004],
   [0.8686, 0.4953, 0.0115],
   [0.8646, 0.5022, 0.0105],
   [-0.8668, 0.4986, -0.0038],
   [-0.8718, 0.4898, -0.0038],
   [-0.8708, 0.4915, -0.0112],
   [-0.8686, 0.4953, -0.0123],
   [-0.8668, 0.4984, -0.0109],
   [0.8718, 0.4898, -0.0038],
   [0.8668, 0.4986, -0.0038],
   [0.8668, 0.4984, -0.0109],
   [0.8708, 0.4915, -0.0112],
   [0.1231, 0.65, -0.7499],
   [0, 0.6171, -0.7869],
   [-0.1231, 0.65, -0.7499],
   [-0.1294, 0.7164, -0.6856],
   [0.1294, 0.7164, -0.6856],
   [-0.2657, 0.5314, -0.8044],
   [-0.4472, 0.8944, 0],
   [0.2262, 0.4524, 0.8626],
   [0.2262, 0.4524, -0.8626],
   [0.4472, 0.8944, 0],
   [0.2657, 0.5314, -0.8044],
   [-0.8457, -0.4991, 0.1889],
   [0.8457, -0.4991, 0.1889],
   [0.8543, -0.5042, 0.126],
   [0.8543, -0.5042, -0.126],
   [-0.846, -0.4993, -0.1871],
   [-0.7994, 0.1263, -0.5873],
   [-0.9712, -0.0625, -0.2298],
   [-0.6153, -0.7471, -0.2514],
   [-0.4592, -0.8852, -0.0749],
   [0.8218, 0.1474, 0.5503],
   [0.954, -0.1046, 0.2808],
   [0.6271, -0.733, 0.2635],
   [0.4524, -0.8891, 0.0699],
   [0.7994, 0.1263, 0.5873],
   [0.9967, -0.0814, 0],
   [0.6472, -0.7623, 0],
   [0.4606, -0.884, 0.0798],
   [-0.8201, 0.152, -0.5517],
   [-0.9967, -0.0814, 0],
   [-0.6472, -0.7623, 0],
   [-0.4588, -0.8854, -0.075],
   [0.1995, 0.9232, 0.3284],
   [0, 0.9933, 0.1156],
   [0, 0.7666, 0.6421],
   [0.0818, 0.7543, 0.6514],
   [0.4459, -0.4201, -0.7903],
   [0.9712, -0.0625, -0.2298],
   [0.6153, -0.7471, -0.2514],
   [-0.4459, -0.4201, -0.7903],
   [0, -0.5031, -0.8642],
   [0, -0.9669, -0.2553],
   [0.7952, 0.3543, 0.492],
   [0.423, 0.662, 0.6187],
   [0, -0.9767, 0.2145],
   [0.0342, -0.9689, 0.2449],
   [0.0907, -0.6414, 0.7618],
   [0, -0.6582, 0.7528],
   [-0.6271, -0.733, 0.2635],
   [-0.0342, -0.9689, 0.2449],
   [-0.0907, -0.6414, 0.7618],
   [-0.452, -0.5445, 0.7064],
   [0.5444, -0.1299, 0.8287],
   [0.1231, -0.1518, 0.9807],
   [0.452, -0.5445, 0.7064],
   [0, -0.1537, 0.9881],
   [-0.1231, -0.1518, 0.9807],
   [-0.5444, -0.1299, 0.8287],
   [0.9546, 0.0238, 0.2968],
   [0.5429, 0.1063, 0.833],
   [-0.1995, 0.9232, 0.3284],
   [-0.7952, 0.3542, 0.492],
   [-0.423, 0.662, 0.6187],
   [-0.0818, 0.7543, 0.6514],
   [-0.954, -0.1046, 0.2808],
   [-0.9546, 0.0238, 0.2968],
   [-0.5429, 0.1063, 0.833],
   [-0.1231, 0.1518, 0.9807],
   [0, 0.1537, 0.9881],
   [0.1231, 0.1518, 0.9807],
   [-0.9189, 0.1649, -0.3584],
   [-0.4515, 0.5372, -0.7124],
   [0, 0.6611, -0.7502],
   [0.0935, 0.622, -0.7774],
   [0.4515, 0.5372, -0.7124],
   [0, 0.59, -0.8074],
   [-0.0935, 0.622, -0.7774],
   [0.9189, 0.1649, -0.3584],
   [-0.8218, 0.1474, 0.5503],
   [-0.4524, -0.8891, 0.0699],
   [0.8201, 0.152, -0.5517],
   [0.4588, -0.8854, -0.075],
   [-0.9163, 0.3625, 0.1702],
   [0.7994, 0.1263, -0.5873],
   [0.4606, -0.884, -0.0798],
   [-0.7994, 0.1263, 0.5873],
   [-0.4592, -0.8852, 0.0749],
   [0.9163, 0.3625, 0.1702],
   [-0.9223, 0.3429, 0.1782],
   [-0.7456, 0.5352, 0.397],
   [-0.7621, -0.1214, 0.6359],
   [-0.9223, 0.3429, -0.1782],
   [-0.7456, 0.5352, -0.397],
   [0.766, -0.0929, 0.6361],
   [0.758, 0.5485, 0.3528],
   [-0.758, 0.5485, 0.3528],
   [-0.766, -0.0929, 0.6361],
   [-0.7621, -0.1214, -0.6359],
   [-0.9893, -0.136, -0.0515],
   [-0.766, -0.0929, -0.6361],
   [0.9893, -0.136, -0.0515],
   [0.766, -0.0929, -0.6361],
   [0.751, -0.1062, -0.6517],
   [0.751, -0.1062, 0.6517],
   [-0.9887, -0.1403, 0.0526],
   [-0.9887, -0.1403, -0.0526],
   [0.1478, 0.2568, 0.9551],
   [-0.1478, 0.2569, 0.9551],
   [0, -1, 0],
];
var carColors = [
   'black', //Black
   'red', //Body
   'brown', //Bottom
   'darkred', //Bumpers
   'ivory', //Lights
   'darkslategray', //Wheels
   'lightskyblue', //Window
];
var carFaces = [
   // Black
   [
      [243, 95, 163, 95, 167, 95, 245, 95, 245, 95],
      [161, 28, 159, 28, 175, 28, 177, 28, 177, 28],
      [180, 32, 179, 32, 191, 32, 192, 32, 192, 32],
      [164, 95, 228, 95, 230, 95, 168, 95, 168, 95],
      [168, 28, 230, 28, 245, 28, 167, 28, 171, 28, 172, 28, 172, 28],
      [228, 95, 243, 95, 245, 95, 230, 95, 230, 95],
      [185, 32, 184, 32, 188, 32, 189, 32, 189, 32],
      [253, 37, 252, 37, 262, 37, 263, 37, 263, 37],
      [251, 3, 249, 3, 259, 3, 261, 3, 261, 3],
      [254, 96, 253, 96, 263, 96, 264, 96, 264, 96],
      [249, 97, 248, 97, 258, 97, 259, 97, 259, 97],
      [248, 98, 255, 98, 265, 98, 258, 98, 258, 98],
      [255, 99, 254, 99, 264, 99, 265, 99, 265, 99],
      [157, 53, 150, 52, 309, 100, 316, 101, 316, 101],
      [155, 84, 154, 83, 313, 102, 314, 103, 314, 103],
      [154, 83, 152, 79, 311, 104, 313, 102, 313, 102],
      [149, 82, 148, 85, 307, 105, 308, 106, 308, 106],
      [256, 90, 257, 81, 267, 107, 266, 108, 266, 108],
      [257, 81, 250, 80, 260, 109, 267, 107, 267, 107],
      [250, 80, 251, 89, 261, 110, 260, 109, 260, 109],
      [252, 91, 256, 90, 266, 108, 262, 111, 262, 111],
      [150, 52, 151, 55, 310, 112, 309, 100, 309, 100],
      [153, 78, 156, 73, 315, 113, 312, 114, 312, 114],
      [156, 73, 157, 53, 316, 101, 315, 113, 315, 113],
      [151, 55, 149, 82, 308, 106, 310, 112, 310, 112],
      [152, 79, 153, 78, 312, 114, 311, 104, 311, 104],
      [148, 85, 155, 84, 314, 103, 307, 105, 307, 105],
   ],
   // Body
   [
      [48, 0, 75, 0, 59, 0, 39, 0, 274, 0, 274, 0],
      [67, 1, 65, 1, 161, 1, 162, 1, 162, 1],
      [80, 2, 41, 2, 253, 2, 254, 2, 254, 2],
      [46, 3, 42, 3, 249, 3, 251, 3, 251, 3],
      [68, 4, 66, 4, 185, 4, 186, 4, 186, 4],
      [33, 5, 87, 5, 57, 5, 57, 5],
      [33, 6, 57, 6, 40, 6, 65, 6, 158, 6, 158, 6],
      [47, 7, 43, 7, 180, 7, 182, 7, 182, 7],
      [65, 8, 67, 8, 165, 8, 163, 8, 163, 8],
      [52, 9, 80, 9, 254, 9, 255, 9, 255, 9],
      [233, 10, 62, 10, 86, 10, 241, 10, 241, 10],
      [196, 10, 37, 10, 85, 10, 200, 10, 200, 10],
      [206, 11, 60, 11, 89, 11, 213, 11, 213, 11],
      [217, 11, 35, 11, 88, 11, 223, 11, 223, 11],
      [57, 12, 87, 12, 145, 12, 141, 12, 141, 12],
      [56, 13, 85, 13, 37, 13, 37, 13],
      [87, 14, 101, 14, 144, 14, 145, 14, 145, 14],
      [88, 15, 100, 15, 112, 15, 112, 15],
      [120, 10, 121, 10, 242, 10, 241, 10, 86, 10, 86, 10],
      [208, 10, 209, 10, 121, 10, 120, 10, 86, 10, 86, 10],
      [101, 16, 82, 16, 140, 16, 144, 16, 144, 16],
      [56, 17, 72, 17, 143, 17, 142, 17, 142, 17],
      [96, 18, 85, 18, 146, 18, 147, 18, 147, 18],
      [82, 19, 57, 19, 141, 19, 140, 19, 140, 19],
      [85, 20, 56, 20, 142, 20, 146, 20, 146, 20],
      [72, 21, 96, 21, 147, 21, 143, 21, 143, 21],
      [233, 22, 220, 22, 39, 22, 42, 22, 66, 22, 62, 22, 62, 22],
      [42, 23, 39, 23, 59, 23, 59, 23],
      [62, 24, 66, 24, 43, 24, 56, 24, 37, 24, 196, 24, 211, 24, 211, 24],
      [158, 25, 65, 25, 41, 25, 58, 25, 35, 25, 35, 25],
      [44, 26, 67, 26, 162, 26, 160, 26, 160, 26],
      [40, 27, 44, 27, 160, 27, 159, 27, 159, 27],
      [65, 28, 40, 28, 159, 28, 161, 28, 161, 28],
      [45, 29, 41, 29, 164, 29, 166, 29, 166, 29],
      [41, 28, 65, 28, 163, 28, 243, 28, 228, 28, 164, 28, 164, 28],
      [68, 30, 47, 30, 182, 30, 181, 30, 181, 30],
      [66, 31, 68, 31, 181, 31, 179, 31, 179, 31],
      [43, 32, 66, 32, 179, 32, 180, 32, 180, 32],
      [42, 33, 46, 33, 183, 33, 184, 33, 184, 33],
      [46, 34, 68, 34, 186, 34, 183, 34, 183, 34],
      [114, 15, 95, 15, 84, 15, 84, 15],
      [122, 11, 123, 11, 216, 11, 213, 11, 89, 11, 89, 11],
      [33, 11, 198, 11, 201, 11, 87, 11, 87, 11],
      [211, 10, 196, 10, 200, 10, 208, 10, 208, 10],
      [62, 10, 211, 10, 208, 10, 86, 10, 86, 10],
      [198, 11, 206, 11, 213, 11, 201, 11, 201, 11],
      [239, 11, 217, 11, 223, 11, 235, 11, 235, 11],
      [39, 10, 220, 10, 222, 10, 84, 10, 84, 10],
      [45, 35, 166, 35, 229, 35, 244, 35, 165, 35, 67, 35, 67, 35],
      [60, 11, 239, 11, 235, 11, 89, 11, 89, 11],
      [66, 32, 42, 32, 184, 32, 185, 32, 185, 32],
      [220, 10, 233, 10, 241, 10, 222, 10, 222, 10],
      [42, 36, 70, 36, 248, 36, 249, 36, 249, 36],
      [41, 37, 45, 37, 252, 37, 253, 37, 253, 37],
      [70, 38, 52, 38, 255, 38, 248, 38, 248, 38],
      [274, 39, 35, 39, 58, 39, 78, 39, 48, 39, 48, 39],
      [88, 40, 35, 40, 274, 40, 90, 40, 100, 40, 100, 40],
      [39, 41, 84, 41, 95, 41, 90, 41, 274, 41, 274, 41],
      [235, 11, 238, 11, 123, 11, 122, 11, 89, 11, 89, 11],
      [222, 10, 226, 10, 115, 10, 114, 10, 84, 10, 84, 10],
      [223, 11, 88, 11, 112, 11, 113, 11, 227, 11, 227, 11],
      [72, 42, 56, 43, 43, 44, 73, 45, 73, 45],
      [76, 46, 71, 47, 54, 48, 69, 49, 69, 49],
      [55, 50, 79, 51, 150, 52, 157, 53, 157, 53],
      [79, 51, 44, 54, 151, 55, 150, 52, 150, 52],
      [70, 56, 75, 57, 48, 58, 52, 59, 52, 59],
      [78, 60, 80, 61, 52, 59, 48, 58, 48, 58],
      [77, 62, 82, 63, 50, 64, 53, 65, 53, 65],
      [79, 51, 83, 66, 67, 67, 44, 54, 44, 54],
      [74, 68, 76, 46, 69, 49, 55, 50, 55, 50],
      [47, 69, 68, 70, 76, 46, 74, 68, 74, 68],
      [42, 71, 59, 72, 75, 57, 70, 56, 70, 56],
      [74, 68, 55, 50, 157, 53, 156, 73, 156, 73],
      [50, 64, 72, 42, 73, 45, 53, 65, 53, 65],
      [55, 50, 69, 49, 83, 66, 79, 51, 79, 51],
      [40, 74, 57, 75, 82, 63, 77, 62, 77, 62],
      [58, 76, 41, 77, 80, 61, 78, 60, 78, 60],
      [43, 44, 47, 69, 153, 78, 152, 79, 152, 79],
      [54, 48, 71, 47, 250, 80, 257, 81, 257, 81],
      [44, 54, 40, 74, 149, 82, 151, 55, 151, 55],
      [53, 65, 73, 45, 154, 83, 155, 84, 155, 84],
      [77, 62, 53, 65, 155, 84, 148, 85, 148, 85],
      [73, 45, 43, 44, 152, 79, 154, 83, 154, 83],
      [40, 74, 77, 62, 148, 85, 149, 82, 149, 82],
      [47, 69, 74, 68, 156, 73, 153, 78, 153, 78],
      [83, 66, 81, 86, 45, 87, 67, 67, 67, 67],
      [68, 70, 46, 88, 71, 47, 76, 46, 76, 46],
      [69, 49, 54, 48, 81, 86, 83, 66, 83, 66],
      [71, 47, 46, 88, 251, 89, 250, 80, 250, 80],
      [45, 87, 81, 86, 256, 90, 252, 91, 252, 91],
      [81, 86, 54, 48, 257, 81, 256, 90, 256, 90],
      [268, 92, 271, 92, 272, 93, 269, 93, 269, 93],
      [270, 94, 273, 94, 271, 92, 268, 92, 268, 92],
   ],
   // Bottom
   [
      [224, 243, 93, 243, 38, 243, 218, 243, 218, 243],
      [225, 243, 97, 243, 49, 243, 221, 243, 221, 243],
      [215, 243, 99, 243, 64, 243, 212, 243, 212, 243],
      [214, 243, 94, 243, 63, 243, 207, 243, 207, 243],
      [212, 243, 64, 243, 94, 243, 214, 243, 214, 243],
      [221, 243, 49, 243, 93, 243, 224, 243, 224, 243],
      [210, 243, 61, 243, 99, 243, 215, 243, 215, 243],
      [219, 243, 34, 243, 97, 243, 225, 243, 225, 243],
      [32, 243, 195, 243, 203, 243, 98, 243, 98, 243],
      [51, 243, 197, 243, 202, 243, 92, 243, 92, 243],
      [92, 243, 202, 243, 199, 243, 36, 243, 36, 243],
      [98, 243, 203, 243, 197, 243, 51, 243, 51, 243],
      [195, 243, 210, 243, 215, 243, 203, 243, 203, 243],
      [197, 243, 212, 243, 214, 243, 202, 243, 202, 243],
      [202, 243, 214, 243, 207, 243, 199, 243, 199, 243],
      [203, 243, 215, 243, 212, 243, 197, 243, 197, 243],
      [232, 243, 219, 243, 225, 243, 237, 243, 237, 243],
      [234, 243, 221, 243, 224, 243, 236, 243, 236, 243],
      [237, 243, 225, 243, 221, 243, 234, 243, 234, 243],
      [236, 243, 224, 243, 218, 243, 240, 243, 240, 243],
      [94, 243, 236, 243, 240, 243, 63, 243, 63, 243],
      [99, 243, 237, 243, 234, 243, 64, 243, 64, 243],
      [64, 243, 234, 243, 236, 243, 94, 243, 94, 243],
      [61, 243, 232, 243, 237, 243, 99, 243, 99, 243],
   ],
   // Bumpers
   [
      [213, 140, 216, 140, 282, 140, 281, 140, 281, 140],
      [201, 141, 213, 141, 281, 141, 276, 141, 276, 141],
      [241, 142, 242, 142, 290, 142, 289, 142, 289, 142],
      [226, 143, 222, 143, 283, 143, 285, 143, 285, 143],
      [222, 144, 241, 144, 289, 144, 283, 144, 283, 144],
      [209, 145, 208, 145, 279, 145, 280, 145, 280, 145],
      [208, 144, 200, 144, 275, 144, 279, 144, 279, 144],
      [281, 11, 282, 11, 294, 11, 293, 11, 293, 11],
      [276, 11, 281, 11, 293, 11, 291, 11, 291, 11],
      [282, 146, 210, 146, 294, 146, 294, 146],
      [280, 10, 279, 10, 297, 10, 298, 10, 298, 10],
      [279, 10, 275, 10, 295, 10, 297, 10, 297, 10],
      [280, 147, 298, 147, 207, 147, 207, 147],
      [285, 10, 283, 10, 299, 10, 300, 10, 300, 10],
      [289, 10, 290, 10, 302, 10, 301, 10, 301, 10],
      [283, 10, 289, 10, 301, 10, 299, 10, 299, 10],
      [285, 148, 300, 148, 218, 148, 218, 148],
      [290, 149, 240, 149, 302, 149, 302, 149],
      [288, 150, 306, 150, 232, 150, 232, 150],
      [227, 151, 113, 152, 34, 153, 219, 154, 219, 154],
      [205, 155, 117, 156, 36, 157, 199, 158, 199, 158],
      [242, 159, 121, 160, 63, 161, 240, 162, 240, 162],
      [216, 163, 123, 164, 61, 165, 210, 166, 210, 166],
      [96, 167, 91, 168, 109, 169, 110, 170, 110, 170],
      [127, 171, 115, 172, 38, 173, 38, 173],
      [129, 174, 119, 175, 49, 176, 97, 176, 97, 176],
      [85, 177, 96, 167, 110, 170, 102, 178, 102, 178],
      [51, 179, 92, 180, 104, 181, 106, 182, 106, 182],
      [119, 175, 127, 171, 93, 176, 49, 176, 49, 176],
      [32, 183, 98, 184, 105, 185, 107, 186, 107, 186],
      [34, 153, 129, 174, 97, 176, 97, 176],
      [131, 187, 137, 188, 104, 181, 103, 189, 103, 189],
      [137, 188, 134, 190, 106, 182, 104, 181, 104, 181],
      [139, 191, 132, 192, 107, 186, 105, 185, 105, 185],
      [134, 190, 139, 191, 105, 185, 106, 182, 106, 182],
      [92, 180, 36, 157, 103, 189, 104, 181, 104, 181],
      [116, 193, 85, 177, 102, 178, 130, 194, 130, 194],
      [101, 195, 87, 196, 108, 197, 111, 198, 111, 198],
      [98, 184, 51, 179, 106, 182, 105, 185, 105, 185],
      [124, 199, 32, 183, 107, 186, 132, 192, 132, 192],
      [91, 168, 101, 195, 111, 198, 109, 169, 109, 169],
      [87, 196, 125, 200, 133, 201, 108, 197, 108, 197],
      [125, 200, 124, 199, 132, 192, 133, 201, 133, 201],
      [36, 157, 117, 156, 131, 187, 103, 189, 103, 189],
      [117, 156, 116, 193, 130, 194, 131, 187, 131, 187],
      [109, 169, 111, 198, 138, 202, 135, 203, 135, 203],
      [135, 203, 138, 202, 139, 191, 134, 190, 134, 190],
      [111, 198, 108, 197, 133, 201, 138, 202, 138, 202],
      [138, 202, 133, 201, 132, 192, 139, 191, 139, 191],
      [110, 170, 109, 169, 135, 203, 136, 204, 136, 204],
      [136, 204, 135, 203, 134, 190, 137, 188, 137, 188],
      [102, 178, 110, 170, 136, 204, 130, 194, 130, 194],
      [130, 194, 136, 204, 137, 188, 131, 187, 131, 187],
      [112, 205, 128, 206, 129, 174, 113, 152, 113, 152],
      [90, 207, 95, 208, 126, 209, 118, 210, 118, 210],
      [118, 210, 126, 209, 127, 171, 119, 175, 119, 175],
      [100, 211, 90, 207, 118, 210, 128, 206, 128, 206],
      [128, 206, 118, 210, 119, 175, 129, 174, 129, 174],
      [95, 208, 114, 212, 126, 209, 126, 209],
      [126, 209, 114, 212, 115, 172, 127, 171, 127, 171],
      [112, 205, 100, 211, 128, 206, 128, 206],
      [38, 173, 93, 176, 127, 171, 127, 171],
      [124, 199, 204, 213, 195, 214, 32, 183, 32, 183],
      [121, 160, 209, 215, 207, 216, 63, 161, 63, 161],
      [87, 196, 201, 217, 125, 200, 125, 200],
      [115, 172, 226, 218, 218, 219, 38, 173, 38, 173],
      [123, 164, 238, 220, 232, 221, 61, 165, 61, 165],
      [129, 174, 34, 153, 113, 152, 113, 152],
      [116, 193, 117, 156, 205, 155, 200, 222, 200, 222],
      [238, 220, 235, 223, 287, 224, 288, 225, 288, 225],
      [235, 223, 223, 226, 284, 227, 287, 224, 287, 224],
      [200, 222, 205, 155, 278, 228, 275, 229, 275, 229],
      [204, 213, 201, 217, 276, 230, 277, 231, 277, 231],
      [223, 226, 227, 151, 286, 232, 284, 227, 284, 227],
      [277, 231, 276, 230, 291, 11, 292, 233, 292, 233],
      [210, 166, 282, 234, 216, 163, 216, 163],
      [204, 213, 277, 231, 195, 214, 195, 214],
      [277, 231, 292, 233, 195, 214, 195, 214],
      [275, 229, 278, 228, 296, 235, 295, 10, 295, 10],
      [199, 158, 278, 228, 205, 155, 205, 155],
      [278, 228, 199, 158, 296, 235, 296, 235],
      [200, 222, 85, 177, 116, 193, 116, 193],
      [125, 200, 201, 217, 204, 213, 124, 199, 124, 199],
      [209, 215, 280, 236, 207, 216, 207, 216],
      [226, 218, 285, 237, 218, 219, 218, 219],
      [240, 162, 290, 238, 242, 159, 242, 159],
      [219, 154, 286, 232, 227, 151, 227, 151],
      [284, 227, 286, 232, 304, 239, 303, 11, 303, 11],
      [287, 224, 284, 227, 303, 11, 305, 11, 305, 11],
      [288, 225, 287, 224, 305, 11, 306, 240, 306, 240],
      [286, 232, 219, 154, 304, 239, 304, 239],
      [238, 220, 288, 225, 232, 221, 232, 221],
   ],
   // Lights
   [
      [143, 241, 147, 241, 146, 241, 142, 241, 142, 241],
      [141, 242, 145, 242, 144, 242, 140, 242, 140, 242],
   ],
   // Wheels
   [
      [0, 11, 1, 11, 2, 11, 3, 11],
      [4, 10, 7, 10, 6, 10, 5, 10],
      [8, 11, 9, 11, 10, 11, 11, 11],
      [12, 10, 15, 10, 14, 10, 13, 10],
      [16, 11, 17, 11, 18, 11, 19, 11],
      [20, 10, 23, 10, 22, 10, 21, 10],
      [24, 11, 25, 11, 26, 11, 27, 11],
      [28, 10, 31, 10, 30, 10, 29, 10],
   ],
   // Window
   [
      [162, 1, 161, 1, 177, 1, 178, 1, 178, 1],
      [166, 95, 164, 95, 168, 95, 170, 95, 170, 95],
      [163, 95, 165, 95, 169, 95, 167, 95, 167, 95],
      [229, 95, 166, 95, 170, 95, 231, 95, 231, 95],
      [167, 8, 169, 8, 173, 8, 171, 8, 171, 8],
      [170, 29, 168, 29, 172, 29, 174, 29, 174, 29],
      [160, 115, 162, 115, 178, 115, 176, 115, 176, 115],
      [159, 116, 160, 116, 176, 116, 175, 116, 175, 116],
      [179, 31, 181, 31, 193, 31, 191, 31, 191, 31],
      [184, 33, 183, 33, 187, 33, 188, 33, 188, 33],
      [186, 4, 185, 4, 189, 4, 190, 4, 190, 4],
      [181, 30, 182, 30, 194, 30, 193, 30, 193, 30],
      [182, 117, 180, 117, 192, 117, 194, 117, 194, 117],
      [244, 95, 229, 95, 231, 95, 246, 95, 246, 95],
      [183, 34, 186, 34, 190, 34, 187, 34, 187, 34],
      [165, 95, 244, 95, 246, 95, 169, 95, 169, 95],
      [169, 35, 246, 35, 247, 35, 173, 35, 173, 35],
      [246, 35, 231, 35, 170, 35, 174, 35, 247, 35, 247, 35],
      [177, 118, 175, 119, 176, 120, 178, 121, 178, 121],
      [192, 122, 191, 123, 193, 124, 194, 125, 194, 125],
      [172, 126, 171, 127, 173, 128, 247, 129, 174, 130, 174, 130],
      [189, 131, 188, 132, 187, 133, 190, 134, 190, 134],
      [258, 135, 265, 136, 267, 107, 260, 109, 260, 109],
      [264, 137, 263, 138, 262, 111, 266, 108, 266, 108],
      [259, 139, 258, 135, 260, 109, 261, 110, 261, 110],
      [265, 136, 264, 137, 266, 108, 267, 107, 267, 107],
      [313, 102, 311, 104, 312, 114, 315, 113, 315, 113],
      [307, 105, 314, 103, 316, 101, 309, 100, 309, 100],
      [314, 103, 313, 102, 315, 113, 316, 101, 316, 101],
      [308, 106, 307, 105, 309, 100, 310, 112, 310, 112],
   ],
];

         function pointProjection( vertex, cam ) {
            if ( cam[2] > vertex[2] ) {
               return;
            }
            scale = eyedist / ( vertex[2] - cam[2] );
            sx = (cam[0]-vertex[0]) * scale; 
            sy = (cam[1]-vertex[1]) * scale; 
            return [ sx * screenHeight / 2, sy * screenHeight / 2 ];
         }

         function roadProjection( vertex, cam ) {
            if ( cam[2] > vertex[2] ) {
               return;
            }
            scale = eyedist / ( vertex[2] - cam[2] );
            sx = (cam[0]-vertex[0]) * scale; 
            sy = (cam[1]-vertex[1]) * scale; 
            sr = roadWidth * scale;
            return [ sx * screenHeight / 2, sy * screenHeight / 2, sr * screenHeight / 2 ];
         }

         function create3D( ax, az ) {
            return [ ax, -2 + Math.cos(ax / 2) / 2 + Math.cos(az / 2) / 2, az  ];
         }

         function drawQuad( color, triplet1, triplet2, roadScale ) { // triplet is [x,w,y]
            context.fillStyle = color;
            context.beginPath();
            context.moveTo( Math.floor(triplet1[0]-triplet1[2]*roadScale+screenWidth/2), Math.floor(triplet1[1]+screenHeight/2) );
            context.lineTo( Math.floor(triplet2[0]-triplet2[2]*roadScale+screenWidth/2), Math.floor(triplet2[1]+screenHeight/2) );
            context.lineTo( Math.floor(triplet2[0]+triplet2[2]*roadScale+screenWidth/2), Math.floor(triplet2[1]+screenHeight/2) );
            context.lineTo( Math.floor(triplet1[0]+triplet1[2]*roadScale+screenWidth/2), Math.floor(triplet1[1]+screenHeight/2) );
            context.closePath();
            context.fill();
         }
         
         function drawPoly( color, faceArr, vsp ) {
            context.fillStyle = color;
            context.beginPath();
            for ( var i = 0; i < faceArr.length; i+= 2 ) {
               if ( !i ) {
                  context.moveTo( Math.floor(vsp[faceArr[i]][0]+screenWidth/2), Math.floor(vsp[faceArr[i]][1]+screenHeight/2) );
               } else {
                  context.lineTo( Math.floor(vsp[faceArr[i]][0]+screenWidth/2), Math.floor(vsp[faceArr[i]][1]+screenHeight/2) );
               }
            }
            context.closePath();
            context.fill();
         }

         function avgFaceZ( faceArr, vs ) {
            var sum = 0;
            var num = 0;
            for ( var i = 0; i < faceArr.length; i+= 2 ) {
               sum += vs[faceArr[i]][2];
               num++;
            }
            return sum/num;
         }
 
         function drawCar( cam ) {
            var scale = 20;
            var modifiedCarVertices = [];
            var projectedVerticles = [];
            for ( var i = 0; i < carVertices.length; i++ ) {
               modified = [ carVertices[i][0] * scale, carVertices[i][1] * scale, carVertices[i][2] * scale ];
               modifiedCarVertices.push( modified );
               projectedVerticles.push( pointProjection( modified, cam ) );
            }
            var sorter = [];
            for ( var i = 0; i < carFaces.length; i++ ) {
               for ( var j = 0; j < carFaces[i].length; j++ ) {
                  sorter.push([i, j, avgFaceZ( carFaces[i][j], modifiedCarVertices )]);
               }
            }
            sorter.sort(function(a,b){
               return (a[2] < b[2]) - (b[2] < a[2]);
            });
            for ( var i = 0; i < sorter.length; i++ ) {
               drawPoly( carColors[sorter[i][0]], carFaces[sorter[i][0]][sorter[i][1]],  projectedVerticles );
            }
         }

         function getSegmentCurve( i ) {
            if ( i < 100 ) {
               return 5;
            }
            if ( i < 200 ) {
               return -5;
            }
            return 0;
         }

         function getSegmentY(i) {
            if ( i > 200 ) {
               return Math.sin(Math.PI*i/50.0)*1500;
            }
            return 0;
         }
         
         function getSegmentTriplet( i, xx, yy ) {
            return roadProjection( [xx,getSegmentY(i),segmentLength*i], [0, camHeight+yy, pos] );
         }

         function Plane(color1, color2) {
            this.color1 = color1;
            this.color2 = color2;
            this.draw  = function() {

               var startPos = Math.floor(pos / segmentLength);
               var xx = 0;
               var yy = getSegmentY(startPos);
               var dx = 0;
               for ( var i = startPos; i <= startPos + numberOfQuads; i++ ) {
                  xx += dx;
                  dx += getSegmentCurve(i);
               }
               for ( var i = startPos + numberOfQuads; i > startPos; i-- ) {
                  var t2 = getSegmentTriplet(i, xx, yy);
                  dx -= getSegmentCurve(i);
                  xx -= dx;
                  var t1 = getSegmentTriplet(i-1, xx, yy);
                  if ( t1 && t2 ) {
                     drawQuad( Math.floor(i/3)%2?'forestgreen':'darkgreen', [0,t1[1],screenWidth/2], [0,t2[1],screenWidth/2], 1.0 );
                     drawQuad( Math.floor(i/3)%2?'white':'black'     , t1, t2, 1.2 );
                     drawQuad( Math.floor(i/3)%2?'grey':'dimgrey'   , t1, t2, 1.0 );
                  }
               }
            };
         }

         var plane = new Plane('green', 'lightgreen');

         function drawBackground() {
            context.fillStyle = "lightblue";
            context.fillRect(0,0,screenWidth,screenHeight);
         }

         function moving() {
            pos+=300;
         }

         // common functions 
         function drawScene() {
            setTimeout( function() {
               drawBackground();
               plane.draw();
               drawCar( [0, 0, -200 ] );
               moving();
               ANIMATION = requestAnimationFrame(drawScene);
            }, 1000 / 50);
         }

         function initCanvas() {
            var style = getComputedStyle(mainItem);
            screenWidth  = mainItem.width  = window.innerWidth  - 20;
            screenHeight = mainItem.height = window.innerHeight - 20;

            // starting the engine only if it is not running
            if ( !ANIMATION ) {
               drawScene();
            }
         }

         //init
         (function() {
            initCanvas();
            addEventListener('resize', initCanvas, false);
         })();
      </script>
   </body>
</html>
