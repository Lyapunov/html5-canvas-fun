<!DOCTYPE HTML>
<html>
   <head>
      <style>
         body {
            margin : 0px;
            padding: 0px;
         }
      </style>
   </head>
   <body>
   	<canvas id="canvas" width="500" height="500">
      </canvas>
      <script>
         var mainItem     = document.getElementById('canvas');
         var context      = mainItem.getContext('2d');

         var screenWidth  = mainItem.width  = window.innerWidth  - 20;
         var screenHeight = mainItem.height = window.innerHeight - 20;
         var screenScale  = Math.min( screenWidth, screenHeight ) / 2;

         var fps = 25;
         var ANIMATION;

         var viewZ = -4;
         var pixelSize = 3;

         var stars = [];
         var starMinX = -6;
         var starMaxX = +6;
         var starMinY = -6;
         var starMaxY = +6;
         var starMaxZDist = 12;
         var starsNumber = 200;

         // Just for fun, using the 'pseudo' random number generator of Sinclair ZX81
         var seed = 131;
         function myRandom() {
            var next = ( 75 * seed ) % 65537;
            seed = next;
            return next;
         }

         function myRandomXYZ() {
            var first = myRandom();
            var second = myRandom();
            var x = starMinX + ( first % 255 ) * ( starMaxX - starMinX ) / 255.0;
            var y = starMinY + ( first / 255 ) * ( starMaxY - starMinY ) / 255.0;
            var z = viewZ + starMaxZDist * ( second % 255 ) / 255.0;
            return [x, y, z];
         }

         function initStars() {
            while ( stars.length < starsNumber ) {
               stars.push( myRandomXYZ() );
            }
         }

         function projection( xyz ) {
            var dz = xyz[2] - viewZ; 
            var sx = xyz[0] / dz;
            var sy = xyz[1] / dz;
            return [ sx * screenScale + screenWidth / 2, sy * screenScale + screenHeight / 2 ];
         }

         function drawPixel( xy ) {
            context.fillStyle = "white";
            context.fillRect( xy[0], xy[1], pixelSize, pixelSize );
         }

         function drawBackground() {
            context.fillStyle = "black";
            context.fillRect(0,0,screenWidth,screenHeight);
         }

         function drawStars() {
            stars.forEach(
               function( xyz ) {
                  drawPixel( projection( xyz ) );
               } );
         }

         // common functions 
         function drawScene() {
            setTimeout( function() {
               drawBackground();
               drawStars();
               ANIMATION = requestAnimationFrame(drawScene);
            }, 1000 / fps );
         }

         function initCanvas() {
            screenWidth  = mainItem.width  = window.innerWidth  - 20;
            screenHeight = mainItem.height = window.innerHeight - 20;
            screenScale  = Math.min( screenWidth, screenHeight ) / 2;

            // starting the engine only if it is not running
            if ( !ANIMATION ) {
               drawScene();
            }
         }

         //init
         (function() {
            initStars();
            initCanvas();
            addEventListener('resize', initCanvas, false);
         })();
      </script>
   </body>
</html>
