<!DOCTYPE HTML>
<html>
   <head>
      <style>
         body {
            margin : 0px;
            padding: 0px;
         }
      </style>
   </head>
   <body>
   	<canvas id="canvas" width="500" height="500" onclick="canvasclick(event);">
      Your browser doesn't support html5 canvas.
      </canvas>
      <script>
         function drawBox(boxX,boxY,boxSize,boxColor) {
            context.beginPath();
            context.rect(boxX, boxY, boxSize, boxSize);
            context.fillStyle = boxColor;
            context.fill();
         }

         function isInBox(x,y,boxX,boxY,boxSize) {
            return x >= boxX && x <= boxX + boxSize && y >= boxY && y <= boxY + boxSize;
         }

         var phase = 0;
         var ix = 0;
         var iy = 1;
         var boxanimdata = 
[
[[20.5,29.3,5],[19.3,34.9,5],[18.3,40.5,5],[17.7,46.9,5],[18.1,52.7,5],[18.5,57.1,5],[18.9,62.099999999999994,5],[19.1,68.1,5],[19.5,74.5,5],[19.5,81.9,5],[17.1,12.3,15],[19,29.4,12],[18.4,47,12],[27.1,32.7,5],[28.5,39.5,5],[28.9,47.5,5],[28.1,55.5,5],[26.7,62.7,5],[22.5,60.7,5],[23.3,67.9,5],[23.3,75.1,5],[24.5,82.3,5],[24.5,88.9,5]],
[[21.9,30.299999999999997,5],[21.1,36.7,5],[21.1,44.3,5],[18.9,51.3,5],[13.899999999999999,55.7,5],[19.7,58.5,5],[19.1,64.3,5],[16.7,69.1,5],[25.5,74.3,5],[33.1,76.9,5],[17.1,11.899999999999999,15],[20,29.799999999999997,12],[19.6,46.4,12],[28.9,32.9,5],[29.700000000000003,40.5,5],[30.5,47.5,5],[30.5,55.1,5],[28.3,62.099999999999994,5],[23.9,59.5,5],[23.3,66.7,5],[23.1,73.3,5],[24.3,81.3,5],[25.9,88.5,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[17.5,29.3,5],[15.100000000000001,35.3,5],[13.7,42.1,5],[12.7,49.1,5],[12.5,56.9,5],[17.9,55.5,5],[17.3,62.099999999999994,5],[17.5,69.5,5],[18.3,77.1,5],[19.1,84.5,5],[17.9,13.100000000000001,15],[19.4,29.4,12],[18.6,43.6,12],[31.299999999999997,32.7,5],[32.7,40.5,5],[32.7,48.7,5],[32.1,56.3,5],[30.299999999999997,63.099999999999994,5],[25.3,56.1,5],[25.5,63.7,5],[26.1,72.3,5],[27.3,80.5,5],[29.1,88.7,5]],
[[18.3,29.1,5],[17.3,35.7,5],[16.7,41.9,5],[15.899999999999999,48.9,5],[14.3,55.3,5],[19.5,55.1,5],[19.1,62.5,5],[18.9,70.3,5],[25.7,69.1,5],[31.700000000000003,67.1,5],[18.1,12.100000000000001,15],[20.6,28.799999999999997,12],[19.8,44.6,12],[31.5,28.7,5],[33.5,35.5,5],[35.1,43.9,5],[34.5,51.1,5],[32.7,58.7,5],[26.9,55.3,5],[26.3,62.099999999999994,5],[26.9,69.3,5],[28.3,77.1,5],[30.1,84.7,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[16.1,31.1,5],[14.5,38.3,5],[13.5,45.5,5],[14.3,52.7,5],[15.5,58.7,5],[20.9,58.3,5],[20.3,65.5,5],[20.5,72.9,5],[20.5,80.1,5],[21.5,88.3,5],[19.7,13.3,15],[21.4,30.200000000000003,12],[21.6,46.4,12],[33.5,31.1,5],[35.7,37.5,5],[36.3,45.1,5],[35.5,52.3,5],[34.9,58.9,5],[29.5,58.7,5],[29.9,65.7,5],[29.5,72.9,5],[28.7,80.7,5],[28.9,87.9,5]],
[[16.7,29.3,5],[15.899999999999999,36.3,5],[15.100000000000001,43.3,5],[14.899999999999999,50.5,5],[15.899999999999999,57.9,5],[21.1,55.5,5],[20.3,63.3,5],[20.9,71.3,5],[23.7,68.5,5],[23.5,64.7,5],[19.9,12.5,15],[21.8,28,12],[21.6,43.4,12],[33.7,28.9,5],[34.3,35.7,5],[34.5,42.7,5],[34.7,50.5,5],[33.7,57.9,5],[28.7,55.5,5],[29.700000000000003,62.099999999999994,5],[29.9,68.7,5],[28.1,75.7,5],[27.5,82.7,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[34.1,27.9,5],[36.5,34.9,5],[37.3,42.9,5],[38.7,49.3,5],[38.5,56.3,5],[25.7,55.5,5],[24.7,64.1,5],[24.5,72.7,5],[23.9,80.7,5],[22.1,88.7,5],[22.7,12.5,15],[24.4,29.4,12],[25.4,43.6,12],[19.9,32.3,5],[18.1,40.3,5],[17.5,47.9,5],[19.3,54.5,5],[20.5,61.3,5],[33.7,54.7,5],[33.9,61.1,5],[33.7,68.3,5],[33.3,76.1,5],[31.5,83.7,5]],
[[29.1,29.9,5],[29.3,36.3,5],[29.9,42.3,5],[30.5,47.7,5],[30.9,52.7,5],[30.9,52.3,5],[30.9,59.3,5],[30.700000000000003,66.3,5],[29.700000000000003,73.7,5],[26.3,80.3,5],[22.9,12.3,15],[24,28.200000000000003,12],[23.2,41.4,12],[20.5,28.9,5],[19.1,35.7,5],[18.5,43.3,5],[20.1,51.5,5],[21.9,58.9,5],[25.3,52.7,5],[25.9,59.7,5],[24.9,66.9,5],[20.1,69.5,5],[14.5,70.7,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[27.9,30.1,5],[29.5,35.1,5],[31.1,40.1,5],[31.1,46.1,5],[30.5,52.5,5],[29.1,57.9,5],[29.700000000000003,63.7,5],[29.1,70.1,5],[28.5,75.5,5],[27.5,81.9,5],[20.5,12.7,15],[21.6,31.200000000000003,12],[22.8,46.4,12],[20.9,33.3,5],[18.7,40.9,5],[18.5,49.1,5],[20.1,55.9,5],[21.1,63.099999999999994,5],[26.1,58.7,5],[26.3,65.9,5],[24.9,72.9,5],[23.9,80.9,5],[22.9,88.7,5]],
[[22.1,32.3,5],[20.1,37.9,5],[18.7,44.7,5],[18.7,52.3,5],[19.7,59.1,5],[26.9,57.5,5],[27.7,63.099999999999994,5],[28.7,69.7,5],[26.5,76.1,5],[24.7,82.3,5],[20.7,12.7,15],[20,30.200000000000003,12],[20.6,45,12],[23.7,32.3,5],[24.9,38.7,5],[26.1,45.9,5],[28.3,52.5,5],[32.3,57.9,5],[23.5,58.1,5],[25.7,63.900000000000006,5],[28.9,69.5,5],[22.5,73.5,5],[15.899999999999999,76.7,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[14.899999999999999,30.299999999999997,5],[13.899999999999999,37.3,5],[13.3,44.3,5],[14.3,50.3,5],[15.7,56.7,5],[20.7,55.9,5],[20.5,62.7,5],[19.9,69.5,5],[18.5,76.7,5],[17.5,83.1,5],[19.1,13.5,15],[19.6,30.200000000000003,12],[20.6,45.6,12],[31.9,32.3,5],[33.3,38.9,5],[34.1,47.1,5],[34.7,54.1,5],[34.3,62.5,5],[28.3,57.5,5],[28.5,63.900000000000006,5],[28.9,72.3,5],[28.7,80.3,5],[27.1,88.7,5]],
[[15.7,29.5,5],[15.5,35.3,5],[14.899999999999999,41.1,5],[14.899999999999999,47.9,5],[15.100000000000001,54.1,5],[19.7,53.9,5],[18.7,60.3,5],[18.1,67.7,5],[17.3,75.3,5],[16.5,82.7,5],[19.5,11.7,15],[19.6,29.200000000000003,12],[19.4,42.8,12],[30.1,30.5,5],[30.299999999999997,37.5,5],[30.700000000000003,44.5,5],[31.700000000000003,51.7,5],[33.1,59.1,5],[26.5,54.7,5],[28.3,61.1,5],[28.3,67.9,5],[24.5,73.1,5],[20.3,79.3,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[16.3,31.1,5],[15.100000000000001,38.3,5],[13.3,45.5,5],[14.100000000000001,52.3,5],[14.7,59.7,5],[20.1,57.7,5],[20.3,65.3,5],[20.5,73.3,5],[20.9,80.1,5],[21.5,87.5,5],[19.9,13.100000000000001,15],[21.4,29.4,12],[21.4,46.4,12],[33.5,30.700000000000003,5],[35.1,37.9,5],[35.9,45.9,5],[35.7,52.7,5],[35.5,59.1,5],[29.9,57.7,5],[29.9,65.1,5],[29.3,73.3,5],[29.3,80.3,5],[28.9,87.3,5]],
[[16.5,28.7,5],[15.3,35.9,5],[15.3,43.7,5],[15.899999999999999,50.7,5],[15.5,57.5,5],[21.3,55.5,5],[20.3,62.099999999999994,5],[19.7,70.7,5],[21.1,78.9,5],[20.7,86.3,5],[19.9,11.7,15],[21.4,27.200000000000003,12],[21.2,42.6,12],[33.5,29.1,5],[34.3,35.7,5],[34.7,43.7,5],[34.3,57.3,5],[34.3,50.5,5],[28.9,55.5,5],[29.9,62.3,5],[30.299999999999997,69.5,5],[28.3,72.5,5],[26.7,76.1,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[32.9,29.3,5],[33.5,36.1,5],[34.9,43.1,5],[34.9,48.9,5],[33.3,55.1,5],[28.1,55.3,5],[28.7,61.7,5],[29.9,68.7,5],[30.9,75.5,5],[31.5,82.3,5],[19.5,11.899999999999999,15],[22.6,30.200000000000003,12],[21,44.6,12],[18.1,31.1,5],[15.899999999999999,38.7,5],[14.5,46.3,5],[14.5,53.5,5],[14.899999999999999,61.3,5],[20.7,57.9,5],[20.3,64.9,5],[20.9,72.5,5],[21.3,79.5,5],[22.1,87.5,5]],
[[33.5,27.9,5],[34.9,33.9,5],[34.3,41.7,5],[33.5,47.1,5],[31.9,52.5,5],[31.700000000000003,55.7,5],[28.9,63.099999999999994,5],[28.1,68.7,5],[32.9,72.5,5],[37.7,75.7,5],[19.5,12.5,15],[24.4,28.4,12],[24.8,43.4,12],[20.3,33.7,5],[21.1,39.3,5],[22.9,47.5,5],[23.1,54.7,5],[23.3,61.3,5],[25.9,55.3,5],[23.9,63.900000000000006,5],[23.3,71.7,5],[24.1,79.7,5],[24.1,87.3,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
[[-30,30,5],[-30,40,5],[-30,50,5],[-30,60,5],[-30,70,5],[-20,30,5],[-20,40,5],[-20,50,5],[-20,60,5],[-20,70,5],[20,0,15],[40,0,12],[60,0,12],[-10,30,5],[-10,40,5],[-10,50,5],[-10,60,5],[-10,70,5],[0,30,5],[0,40,5],[0,50,5],[0,60,5],[0,70,5]],
];

         var bcolors=['lightred','lightred','lightred','lightred','lightred',
                      'magenta','magenta','magenta','magenta','magenta',
                      'blue','blue','blue',
                      'orange','orange','orange','orange','orange',
                      'cyan','cyan','cyan','cyan','cyan'];
         var selected = -1;
         function initboxanimdata() {
            for ( var i = 0; i < 72; ++i ) {
               var onedata = [];
               for ( var x = 0; x < 2; ++x ) {
                  for ( var y = 0; y < 5; ++y ) {
                     onedata.push([x*10-30,(y+1)*10+20,5]);
                  }
               }
               onedata.push([20,0,15]);
               onedata.push([40,0,12]);
               onedata.push([60,0,12]);
               for ( var x = 0; x < 2; ++x ) {
                  for ( var y = 0; y < 5; ++y ) {
                     onedata.push([(x+2)*10-30,(y+1)*10+20,5]);
                  }
               }
               boxanimdata.push(onedata);
            }
         }

         function getKey() {
            return ix*9 + iy*(phase+1);
         }

         function canvasclick(evnt) {
            console.log('--->canvasclick',evnt);
            if ( isInBox(evnt.clientX,evnt.clientY,10,300,30) ) {
               console.log("Btn1");
               phase = (phase + 1)%8;
               console.log('phase:',phase,'ix:',ix,"iy:",iy,'key:',getKey());
               return;
            }
            if ( isInBox(evnt.clientX,evnt.clientY,50,300,30) ) {
               console.log("Btn2");
               ix = (ix + 1)%8;
               console.log('phase:',phase,'ix:',ix,"iy:",iy,'key:',getKey());
               return;
            }
            if ( isInBox(evnt.clientX,evnt.clientY,90,300,30) ) {
               console.log("Btn3");
               iy = 1-iy;
               console.log('phase:',phase,'ix:',ix,"iy:",iy,'key:',getKey());
               return;
            }
            if ( isInBox(evnt.clientX,evnt.clientY,130,300,30) ) {
               console.log("Btn4");
               console.log("# START");
               for ( var i = 0; i < boxanimdata.length;++i ) {
                  console.log("#" + i);
                  console.log(JSON.stringify(boxanimdata[i]));
               }
               console.log("# END");
               return;
            }
            var bdata = boxanimdata[getKey()];
            if ( selected == -1 ) {
               for ( var i = 0; i < bdata.length; ++i ) {
                  if ( isInBox(evnt.clientX,evnt.clientY,500+bdata[i][0]*5,100+bdata[i][1]*5,bdata[i][2]*5) ) {
                     selected = i;
                     return;
                  }
               }
            } else {
               bdata[selected][0] = (evnt.clientX-500)/5-bdata[selected][2]/2;
               bdata[selected][1] = (evnt.clientY-100)/5-bdata[selected][2]/2;
               selected = -1;
            }
         }
         var mainItem     = document.getElementById('canvas');
         var context      = mainItem.getContext('2d');

         var screenWidth  = mainItem.width  = window.innerWidth  - 20;
         var screenHeight = mainItem.height = window.innerHeight - 20;
         var screenScale  = Math.min( screenWidth, screenHeight ) / 2;

         var fps = 25;
         var ANIMATION;

         // http://www.williammalone.com/articles/create-html5-canvas-javascript-sprite-animation/
         var animImages = [];
         for ( var i = 0; i < 8; ++i ) {
            var animImage = new Image();
            animImage.src = "avatars/avatar-"+i+".png";
            animImages.push(animImage);
         }

         function drawRImage(rimage, ux, uy, ds) {
            for ( var i = 0; i < rimage.yellows.length; ++i ) {
                var item = rimage.yellows[i];
                var dx = item[0];
                var dy = item[1];
                var len = item[2];
                context.fillStyle = "yellow";
                context.fillRect(ux+(dx-len+1)*ds,uy+dy*ds,ds*len,ds);
            }
            for ( var i = 0; i < rimage.reds.length; ++i ) {
                var item = rimage.reds[i];
                var dx = item[0];
                var dy = item[1];
                var len = item[2];
                context.fillStyle = "red";
                context.fillRect(ux+(dx-len+1)*ds,uy+dy*ds,ds*len,ds);
            }
            for ( var i = 0; i < rimage.blacks.length; ++i ) {
                var item = rimage.blacks[i];
                var dx = item[0];
                var dy = item[1];
                context.fillStyle = "black";
                context.fillRect(ux+dx*ds,uy+dy*ds,ds,ds);
            }
         }

         var printed = 0;
         function drawBackground() {
            context.fillStyle = "green";
            context.fillRect(0,0,screenWidth,screenHeight);
            context.drawImage(animImages[phase],0,0,500,280);

            context.beginPath();
            context.lineWidth = "1";
            context.strokeStyle = "darkgreen";
            var gridx = 54.5;
            var gridy = 122;
            var shx = 29;
            var shy = 25;
            var areax = 54;
            var areay = 100;
            for ( var x = 0; x < 8; ++x ) {
               for ( var y = 0; y < 2; ++y ) {
                  context.rect(shx+Math.floor(gridx*x),shy+gridy*y,areax,areay);
               }
            }
            context.stroke();
            var cntr = 0;
            var rude = 1;
            var rimage = { blacks:[], reds:[], yellows:[] };
            for ( var dy = 0; dy < areay; ++dy ) {
                for ( var dx = 0; dx < areax; ++dx ) {
                  var dat = context.getImageData(shx+dx+Math.floor(ix*gridx),shy+iy*gridy+dy,1,1);
                  if ( !dat.data[0] && !dat.data[1] && !dat.data[2] ) {
                     // black
                     rimage.blacks.push([dx,dy]);
                     ++cntr;
                  } else if ( dat.data[0] && !dat.data[1] && !dat.data[2] ) {
                     // red
                     var cdid = [dx,dy,1];
                     if ( rimage.reds.length && rimage.reds[rimage.reds.length-1][0] == dx-1 && rimage.reds[rimage.reds.length-1][1] == dy ) {
                        var lst = rimage.reds[rimage.reds.length-1];
                        rimage.reds[rimage.reds.length-1] = [dx,dy,lst[2]+1];
                     } else {
                        rimage.reds.push(cdid);
                     }
                  } else if ( !(!dat.data[0] && dat.data[1] && !dat.data[2]) ) {
                     // yellow
                     var cdid = [dx,dy,1];
                     if ( rimage.yellows.length && rimage.yellows[rimage.yellows.length-1][0] == dx-1 && rimage.yellows[rimage.yellows.length-1][1] == dy ) {
                        var lst = rimage.yellows[rimage.yellows.length-1];
                        rimage.yellows[rimage.yellows.length-1] = [dx,dy,lst[2]+1];
                     } else {
                        rimage.yellows.push(cdid);
                     }

                  }
               }
            }

            drawRImage(rimage,500,100,5);
            if ( !printed ) {
               printed = 1;
               console.log('{blacks:[',rimage.blacks.toString(),'],');
               console.log('yellows:[',rimage.yellows.toString(),'],');
               console.log('reds:[',rimage.reds.toString(),']}');
            }

            drawBox(10,300,30,'orange');
            drawBox(50,300,30,'orange');
            drawBox(90,300,30,'orange');
            drawBox(130,300,30,'blue');

            boxanimdata[getKey()].map((box,i)=>drawBox(500+box[0]*5,100+box[1]*5,box[2]*5,bcolors[i]));
         }

         // common functions 
         function drawScene() {
            setTimeout( function() {
               drawBackground();
               ANIMATION = requestAnimationFrame(drawScene);
            }, 1000 / fps );
         }

         function initCanvas() {
            screenWidth  = mainItem.width  = window.innerWidth  - 20;
            screenHeight = mainItem.height = window.innerHeight - 20;
            screenScale  = Math.min( screenWidth, screenHeight ) / 2;

            // starting the engine only if it is not running
            if ( !ANIMATION ) {
               drawScene();
//               initboxanimdata();
            }
         }

         //init
         (function() {
            initCanvas();
            addEventListener('resize', initCanvas, false);
         })();
      </script>
   </body>
</html>
